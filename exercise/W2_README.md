# 第二周练习：K-means聚类分析与BGE-m3情感分类

本周练习包含两个主要任务，使用机器学习技术进行用户画像聚类分析和文本情感分类。

## 练习目标

1. **K-means用户画像聚类**：基于第一周的用户画像数据，使用K-means算法找到代表性样本，并通过PCA可视化展示聚类中心的特征分布
2. **BGE-m3情感分类**：使用BGE-m3嵌入模型提取文本特征，结合逻辑回归实现中文文本的情感分类

## 文件结构

```
week2/
├── README.md                           # 本说明文档
├── requirements.txt                    # 依赖包列表
├── R1_kmeans_user_clustering.py        # K-means聚类分析
├── R2_sentiment_classification.py     # BGE-m3情感分类
└── 输出文件/
    ├── user_clustering_results.csv     # 聚类结果
    └── representative_samples.csv      # 代表性样本（如果生成）
```

## 练习1：K-means用户画像聚类分析 (`R1_kmeans_user_clustering.py`)

### 功能特点

- **数据源**：使用第一周生成的用户画像数据 (`../week1/user_profiles.csv`)
- **特征工程**：使用BGE-m3模型对类别特征进行语义编码
- **聚类优化**：通过肘部法和轮廓系数确定最优聚类数量
- **可视化**：提供2D/3D静态和交互式聚类结果展示
- **代表性样本**：识别每个聚类中距离中心最近的样本

### 核心算法流程

1. **特征编码**：类别特征使用BGE-m3编码，数值特征标准化处理
2. **聚类数选择**：测试2-10个聚类，选择轮廓系数最高的配置
3. **聚类执行**：使用最优参数运行K-means算法
4. **降维可视化**：通过PCA降维到3维空间进行可视化
5. **结果分析**：分析各聚类的特征分布和代表性样本

### 输出结果

- 聚类优化过程的可视化图表
- 3D聚类结果可视化（静态和交互式）
- 各聚类的详细特征分析
- 代表性样本识别和保存

## 练习2：BGE-m3情感分类 (`R2_sentiment_classification.py`)

### 功能特点

- **数据集**：包含30个中文文本样本，涵盖正面、负面两种情感（各15个）
- **嵌入模型**：使用BGE-m3提取1024维文本语义特征
- **分类器**：逻辑回归二分类模型，使用默认参数
- **权重分析**：分析逻辑回归模型的特征权重和重要性

### 核心算法流程

1. **数据创建**：创建包含30个中文文本的二分类数据集
2. **特征提取**：使用BGE-m3模型生成文本嵌入向量
3. **模型训练**：逻辑回归模型训练（使用所有数据）
4. **权重分析**：分析模型权重，识别最重要的特征维度
5. **可视化展示**：可视化Top 10重要维度的权重分布

### 技术亮点

- **语义编码**：使用先进的BGE-m3多语言嵌入模型
- **权重分析**：深入分析逻辑回归模型的特征重要性
- **可视化**：直观展示最重要特征维度的权重分布
- **中文支持**：完整的中文文本处理和可视化

## 环境要求

### Python版本
- Python >= 3.8

### 主要依赖包
```
sentence-transformers>=2.2.0
scikit-learn>=1.3.0
pandas>=1.5.0
numpy>=1.24.0
matplotlib>=3.6.0
seaborn>=0.12.0
plotly>=5.10.0
```

## 运行说明

### 前置条件
1. 确保已完成第一周练习，生成了 `user_profiles.csv` 文件
2. 安装所有依赖包：`pip install -r requirements.txt`
3. 确保有足够的内存运行BGE-m3模型（建议8GB以上）

### 执行步骤

#### 练习1：K-means聚类分析
```bash
cd exercises/week2
python R1_kmeans_user_clustering.py
```

#### 练习2：情感分类
```bash
cd exercises/week2  
python R2_sentiment_classification.py
```

## 预期输出

### 练习1输出
- 聚类数量优化图表
- 3D聚类可视化
- 聚类特征分析报告
- `user_clustering_results.csv`：完整聚类结果
- `representative_samples.csv`：代表性样本

### 练习2输出
- 模型训练过程输出
- 数据集统计信息
- 权重分析报告
- Top 10重要维度的权重可视化图表

## 学习要点

### K-means聚类部分
- 理解聚类算法的工作原理和参数选择
- 掌握肘部法和轮廓系数等聚类评估方法
- 学习高维数据的降维可视化技术
- 了解代表性样本的识别方法

### 情感分类部分
- 掌握预训练语言模型的特征提取应用
- 理解逻辑回归在文本分类中的使用
- 学习模型权重分析和特征重要性评估
- 了解二分类文本情感分析的基础流程
